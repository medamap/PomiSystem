# X1 PCG Converter

SHARP X1 / X1turbo 向け PCG 画像変換ツール

## 概要

任意の画像を X1 系の 8色 PCG (8x8 タイル) に合わせて変換する。高解像度モードや PCG 定義数の拡張にも対応している。

## 対応仕様

### X1 標準相当

- 解像度: 320 x 200 (X1turbo)
- タイル: 8 x 8 ピクセル
- パレット: デジタル RGB 8色固定
- PCG 定義数: 標準 256

### 拡張出力

- X1turbo 2倍 (640 x 400), 4倍 (1280 x 800)
- QVGA / VGA
- SVGA 〜 UHD/4K までの高解像度
- オート (アスペクト比維持)
- PCG 定義数上限: 最大 2048
- 無制限モード (PCG リデュースなし)

## 機能

### 出力設定

| 項目 | 選択肢 |
|---|---|
| 出力サイズモード | X1turbo, X1turbo 2倍/4倍, オート, QVGA/VGA, SVGA〜UHD |
| トリミング位置 | 25% - 75% (上下または左右) |
| ディザリング | なし, Bayer 2x2, Bayer 4x4, Floyd-Steinberg, Atkinson |

高解像度モードでは無制限モードが自動で有効になる。

### 色相考慮 (肌色改善)

| 項目 | 範囲 | 標準値 |
|---|---|---|
| 色相を考慮した色選択 | ON/OFF | ON |
| 色相重視度 | 0 - 100% | 30% |

### PCG 設定

| 項目 | 範囲 | 標準値 |
|---|---|---|
| 無制限モード | ON/OFF | OFF |
| PCG 定義数上限 | 128 - 2048 (32刻み) | 256 |
| タイル類似度閾値 | 0 - 50 | 15 |
| エッジタイル保護 | ON/OFF | ON |
| エッジ保護強度 | 0 - 100% | 50% |

### 色調整

| 項目 | 範囲 |
|---|---|
| 明度 | -100 - +100 |
| コントラスト | -100 - +100 |
| 彩度 | -100 - +100 |

### その他

- リアルタイムプレビュー (重い場合は OFF 推奨)
- 設定保存 / リセット

## 処理フロー

1. 画像読み込みとトリミング
2. 色調整 (明度, コントラスト, 彩度)
3. デジタル8色への減色 (色相考慮オプション含む)
4. 8x8 タイル抽出
5. ユニークタイル検出と類似度統合
6. PCG 上限に合わせたリデュース (無制限モード時は省略)
7. 出力画像と PCG 定義画像の生成

## 出力形式

### 出力画像

変換後の画像。PNG 形式で保存またはクリップボードにコピーできる。

### PCG 定義画像

使用されるタイルを並べた画像。16タイル/行を基本とし、タイル数に応じて列数を調整する。PNG 形式で保存できる。

## 使い方

1. 画像をドラッグアンドドロップまたはファイル選択で読み込む
2. 出力モードと各種設定を調整
3. 「変換実行」ボタンをクリック
4. 出力画像と PCG 定義画像を保存またはコピー

## 既知の問題

特になし。

## 技術詳細

- デジタル RGB 8色固定パレットへ最短距離でマッピング
- 色相考慮は HSL の色相差を加味して色選択を補正
- エッジ保護は輪郭を含むタイルを優先保持し、リデュースによる輪郭欠損を抑える
